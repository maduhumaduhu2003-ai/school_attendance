<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Login | {{ school_settings.school_name|default:"School Attendance System" }}</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">

<style>
:root {
    --primary-color: #4f46e5;
    --primary-dark: #4338ca;
    --secondary-color: #10b981;
    --accent-color: #f59e0b;
    --card-color: rgba(255,255,255,0.85);
    --text-primary: #1f2937;
    --text-secondary: #6b7280;
    --border-color: #e5e7eb;
    --shadow-lg: 0 10px 25px -5px rgba(0,0,0,0.1);
    --gradient-primary: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
}

/* Reset */
* { margin:0; padding:0; box-sizing:border-box; }

body {
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    min-height:100vh;
    display:flex;
    align-items:center;
    justify-content:center;
    background: #1e293b;
    position: relative;
    overflow: hidden;
}

body::before {
    content: "";
    position: fixed;
    top:0;
    left:0;
    width:100%;
    height:100%;
    background: url("{% if school_settings.logo %}{{ school_settings.logo.url }}{% else %}/static/images/logo.png{% endif %}") center center/cover no-repeat;
    z-index:-2;
    filter: brightness(0.25);
}

body::after {
    content:"";
    position: fixed;
    top:0;
    left:0;
    width:100%;
    height:100%;
    background: rgba(0,0,0,0.15);
    z-index:-1;
}

/* Animated bubbles */
.bg-bubble-1, .bg-bubble-2, .bg-bubble-3 {
    position: fixed;
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.08);
    z-index: -1;
    animation: float 20s infinite ease-in-out;
}
.bg-bubble-1 { width: 300px; height: 300px; top:-150px; right:-150px; animation-delay:0s; }
.bg-bubble-2 { width: 200px; height: 200px; bottom:-100px; left:-100px; animation-delay:5s; }
.bg-bubble-3 { width: 150px; height: 150px; top:50%; left:-75px; animation-delay:10s; }

@keyframes float {
    0%,100% { transform: translateY(0) rotate(0deg); }
    33% { transform: translateY(-30px) rotate(120deg); }
    66% { transform: translateY(30px) rotate(240deg); }
}

/* Login container */
.login-container { width:100%; max-width:360px; padding: 0 15px; animation:slideUp 0.6s ease-out; }

/* Login card */
.login-card {
    background: var(--card-color);
    border-radius:20px;
    box-shadow: var(--shadow-lg);
    overflow:hidden;
    position: relative;
    border: 1px solid rgba(255, 255, 255, 0.2);
    backdrop-filter: blur(10px);
}

/* Card header */
.card-header {
    padding: 1.5rem 1.5rem 1rem;
    text-align:center;
    background: rgba(255,255,255,0.7);
    backdrop-filter: blur(5px);
    border-bottom: 1px solid var(--border-color);
}
.school-logo {
    width:70px;
    height:70px;
    border-radius:50%;
    object-fit:cover;
    margin:0 auto 0.75rem;
    padding:6px;
    background:white;
    box-shadow:0 3px 8px rgba(0,0,0,0.1);
}
.school-name { color: var(--primary-color); font-size:1.4rem; font-weight:700; }

/* Card body */
.card-body { padding:1.25rem 1.5rem 1.5rem; }

.form-control {
    padding:0.75rem 1rem;
    border:2px solid var(--border-color);
    border-radius:10px;
}

.password-toggle {
    position:absolute;
    right:12px;
    top:50%;
    transform:translateY(-50%);
    cursor:pointer;
    background:none;
    border:none;
}

/* Footer */
.card-footer {
    padding:1rem;
    text-align:center;
    font-size:0.8rem;
}
</style>
</head>

<body>

<div class="bg-bubble-1"></div>
<div class="bg-bubble-2"></div>
<div class="bg-bubble-3"></div>

<div class="login-container">
    <div class="login-card">

        <div class="card-header">
            {% if school_settings.logo %}
                <img src="{{ school_settings.logo.url }}" class="school-logo">
            {% else %}
                <img src="/static/images/logo.png" class="school-logo">
            {% endif %}
            <h1 class="school-name">{{ school_settings.school_name|default:"School Attendance System" }}</h1>
        </div>

        <div class="card-body">
            {% if messages %}
                {% for message in messages %}
                    <div class="alert alert-danger">{{ message }}</div>
                {% endfor %}
            {% endif %}

            <form method="post">
                {% csrf_token %}

                <input type="email" name="username" class="form-control mb-3" placeholder="Email" required>

                <div class="position-relative mb-3">
                    <input type="password" id="password" name="password" class="form-control" placeholder="Password" required>
                    <button type="button" class="password-toggle" onclick="togglePassword()">
                        <i class="bi bi-eye"></i>
                    </button>
                </div>

                <button class="btn btn-primary w-100 mb-3">Login</button>

                <div class="text-center">
                    <a href="{% url 'forgot_password' %}">Forgot password?</a>
                </div>

                {% if not admin_exists %}
                <div class="mt-3">
                    <a href="{% url 'register_admin' %}" class="btn btn-outline-primary w-100">
                        Register Admin
                    </a>
                </div>
                {% endif %}
            </form>
        </div>

        <div class="card-footer">
            &copy; {{ year|default:"2025" }} {{ school_settings.school_name }}
        </div>

    </div>
</div>

<script>
function togglePassword() {
    const p = document.getElementById("password");
    p.type = p.type === "password" ? "text" : "password";
}
</script>

</body>
</html>
